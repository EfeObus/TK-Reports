# TK Reports

**TK Reports** is a Flask-powered Insight Reporting Application that automatically transforms structured datasets (Excel, CSV, SQL and others) into full Canadian-standard insight reports.  
It interprets data, generates key findings using OpenAI GPT, embeds charts directly into the document, and exports everything as a professional PDF or Word (.docx) report.

TK Reports is designed for executives, researchers, and analysts who need actionable insights‚Äînot raw analytics dashboards.

---

## Overview

The system performs five main tasks:

1. **Accepts data uploads** in multiple formats.
2. **Cleans and summarizes** the dataset automatically.
3. **Generates narrative insights** using OpenAI.
4. **Embeds charts and tables** directly inside the report.
5. **Exports the finished report** as a downloadable PDF or DOCX.

All reports follow **Canadian professional report formatting**‚Äîclear headers, metric units, and bilingual-ready layout.

---

## Core Features

- ‚úÖ Accepts `.xlsx`, `.csv`, `.tsv`, or SQL datasets
- ‚úÖ Automatic profiling and summary generation
- ‚úÖ OpenAI-based natural-language interpretation
- ‚úÖ Charts and tables embedded directly within the report
- ‚úÖ PDF and DOCX export support
- ‚úÖ Secure `.env` management for the OpenAI API key
- ‚úÖ Designed for Canadian business and academic standards

---

## Architecture

| Layer | Technology | Function |
|-------|-----------|----------|
| **Frontend** | Flask (Jinja2 + Bootstrap) | File upload and report download interface |
| **Backend** | Flask + Python | Routing and report orchestration |
| **Data Engine** | Pandas + NumPy | Profiling and statistical summaries |
| **Visualization** | Matplotlib / Seaborn | Generates charts embedded in the report |
| **AI Engine** | OpenAI API (GPT-4 Turbo) | Narrative insight generation |
| **Report Builder** | python-docx + FPDF2 | Combines text and visuals into DOCX/PDF |
| **Environment Config** | python-dotenv | Secure API key loading from `.env` |
| **Database (Optional)** | SQLAlchemy | SQL dataset integration |

---

## Installation

### Prerequisites

- Python 3.9 or higher
- Valid OpenAI API Key
- `pip` and `virtualenv` installed

### Steps

1. **Clone the Repository**
   ```bash
   git clone https://github.com/<your-username>/tk-reports.git
   cd tk-reports
   ```

2. **Create a Virtual Environment**
   ```bash
   python -m venv venv
   source venv/bin/activate      # macOS/Linux
   venv\Scripts\activate         # Windows
   ```

3. **Install Dependencies**
   ```bash
   pip install -r requirements.txt
   ```

4. **Set Up the OpenAI Key**  
   Create a `.env` file in the project root:
   ```
   OPENAI_API_KEY=your_openai_api_key_here
   ```

5. **Run the Application**
   ```bash
   flask run --port=5016
   ```

6. **Access the App**
   ```
   http://127.0.0.1:5016
   ```

---

## Usage

1. Open the app in your browser.
2. Upload your dataset (`.csv`, `.xlsx`, or SQL connection).
3. The app analyzes and profiles the data.
4. The AI engine creates a written narrative explaining findings.
5. Charts and tables are generated and embedded into the report.
6. Download your final DOCX or PDF report.

---

## Report Structure

**Report Title:**  
*Insight Report ‚Äì Generated by TK Reports*

**Prepared By:** TK Reports  
**Date:** [YYYY-MM-DD]  
**Locale:** en_CA

### Sections

1. **Executive Summary** (AI-generated)
2. **Dataset Overview**
3. **Key Metrics and Visual Summaries** (with embedded charts)
4. **Narrative Insights and Recommendations**
5. **Appendix** (Supporting Tables and Notes)

**Output Files:**
- `tk_report_<timestamp>.pdf`
- `tk_report_<timestamp>.docx`

All charts and tables are rendered inside the report‚Äîno external image links.

---

## Example Configuration (config.yaml)

```yaml
report:
  title: "TK Insight Report"
  author: "TK Reports"
  include_charts: true
  include_narrative: true
  export_formats: ["pdf", "docx"]
  locale: "en_CA"

openai:
  model: "gpt-4-turbo"
  temperature: 0.3
```

---

## Dependencies

- `flask`
- `pandas`
- `numpy`
- `matplotlib`
- `seaborn`
- `python-docx`
- `fpdf2`
- `openai`
- `python-dotenv`
- `sqlalchemy`
- `werkzeug`
- `openpyxl`
- `pyyaml`

---

## Future Enhancements

- üåê Dual-language (English/French) report templates
- ‚òÅÔ∏è Cloud storage integration (Google Drive, OneDrive)
- üìä Sector-specific report styles (finance, research, education)
- üìà Automated trend forecasting module
- üë• User accounts and collaborative report editing

---

## License

Licensed under the **MIT License**.  
Use, modify, and distribute freely with attribution.

---

## Author

**Efe Obukohwo**  
Toronto, Ontario, Canada  
Email: talk2efeprogress@gmail.com  
GitHub: [github.com/EfeObus](https://github.com/EfeObus)
